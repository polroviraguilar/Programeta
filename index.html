<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Programeta</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <!-- CAPÇALERA -->
  <header class="topbar">
    <div class="topbar__inner">
      <span class="brand__name">Programeta</span>
      <button id="toggleSidebar" class="btn ghost small">☰ Menú</button>
      <button id="toggleSubheader" class="btn ghost small">Ajuda ▼</button>      
    </div>
  </header>

  <!-- SUBCAPÇALERA desplegable -->
  <section id="subheader" class="subheader hidden">
    <div class="subheader__content">
      <div class="callout">
        <strong>Com funciona:</strong>
        <ul>
          <li><b>Horari · Setmanal</b>: clica una cel·la per <i>Afegir/Editar</i> una franja.</li>
          <li><b>Horari · Anual</b>: tria una setmana per navegar-hi ràpid.</li>
          <li><b>Lliçonari</b>: filtra activitats per curs/assignatura.</li>
        </ul>
      </div>
    </div>
  </section>

  <div class="layout">
    <!-- MENÚ LATERAL -->
    <aside class="sidebar">
      <nav class="side-nav">
        <button class="side-link active" data-tab="horari">📅 Horari</button>
        <button class="side-link" data-tab="lliconari">📚 Lliçonari</button>
      </nav>
    </aside>

    <!-- CONTINGUT -->
    <main id="main" class="content">
      <!-- Horari -->
      <section id="tab-horari">
        <nav id="horariTabs" class="tabs sub-tabs">
          <button class="tab active" data-subtab="setmanal">Setmanal</button>
          <button class="tab" data-subtab="anual">Anual</button>
        </nav>

        <!-- Setmanal -->
        <section id="subtab-setmanal" class="card">
          <div class="section-head">
            <h3>Planificació setmanal</h3>
            <div class="badge" id="weekLabel">—</div>
          </div>
          <div class="toolbar">
            <button id="prevWeek" class="btn ghost">← Setmana anterior</button>
            <span id="weekRange" class="muted">—</span>
            <button id="nextWeek" class="btn ghost">Setmana següent →</button>
          </div>
          <table id="weekGrid" class="week-grid"></table>
        </section>

        <!-- Anual -->
        <section id="subtab-anual" class="card hidden">
          <div class="section-head">
            <h3>Calendari anual</h3>
            <div class="badge" id="yearLabel">—</div>
          </div>
          <div class="toolbar">
            <button id="prevYear" class="btn ghost">← Any anterior</button>
            <button id="nextYear" class="btn ghost">Any següent →</button>
          </div>
          <div id="yearGrid" class="year-grid"></div>
        </section>
      </section>

      <!-- Lliçonari -->
      <section id="tab-lliconari" class="hidden">
        <section class="card">
          <div class="section-head">
            <h3>Lliçonari</h3>
          </div>
          <div class="filters">
            <input id="fCurs" placeholder="Filtra per curs" />
            <input id="fAssignatura" placeholder="Filtra per assignatura" />
            <button id="filtraLlicons" class="btn ghost">Aplicar</button>
            <button id="netejaFiltres" class="btn ghost">Netejar</button>
            <button id="imprimirLlicons" class="btn ghost">🖨️</button>
            <button id="descarregarCSV" class="btn ghost">⬇️</button>
          </div>
          <div id="llistaLlicons" class="list"></div>
        </section>
      </section>
    </main>
  </div>

  <!-- PEU -->
  <footer class="footer">
    <div class="footer__inner">© Programeta</div>
  </footer>

  <script type="module" src="js/firebase.js"></script>
  <script type="module" src="js/app.firebase.js"></script>
  <script>
  // Subcapçalera desplegable
  document.getElementById('toggleSubheader').addEventListener('click', ()=>{
    document.getElementById('subheader').classList.toggle('hidden');
  });

  // Menú lateral (canvi de secció)
  document.querySelector('.side-nav').addEventListener('click', e=>{
    const btn = e.target.closest('.side-link'); if(!btn) return;
    document.querySelectorAll('.side-link').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('tab-horari').classList.toggle('hidden', btn.dataset.tab!=='horari');
    document.getElementById('tab-lliconari').classList.toggle('hidden', btn.dataset.tab!=='lliconari');
  });

  // 👉 Plegar/desplegar la sidebar
  document.getElementById('toggleSidebar').addEventListener('click', ()=>{
    document.body.classList.toggle('sidebar-collapsed');
  });
</script>

  <!-- MODAL: Editor franja (requisit per al JS) -->
<dialog id="franjaDlg" class="modal" aria-labelledby="dlg-title" aria-modal="true">
  <h3 id="dlg-title">Editar franja</h3>

  <div class="form-grid">
    <input id="fdia" readonly />
    <input id="fhora" readonly />
    <input id="fcurs" placeholder="Curs (p. ex. 5è)" />
    <input id="fassignatura" placeholder="Assignatura (p. ex. Música)" />
    <textarea id="factivitat" rows="3" placeholder="Activitat"></textarea>
    <select id="ftipus" title="Defineix si és esporàdica o permanent">
      <option value="ocasional">Ocasional (només aquesta setmana)</option>
      <option value="permanent">Permanent (cada setmana)</option>
    </select>
  </div>

  <div class="modal__actions">
    <button id="delFranja" class="btn danger" data-tooltip="Elimina la franja">Eliminar</button>
    <div class="modal__spacer"></div>
    <button id="cancelFranja" class="btn ghost">Cancel·lar</button>
    <button id="saveFranja" class="btn primary" data-tooltip="Desa els canvis">Desar</button>
  </div>
</dialog>
</body>
</html>
